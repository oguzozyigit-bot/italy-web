<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <title>italky Word-Drop (Pure Board)</title>
    <style>
        /* Sizin paylaştığınız CSS yapısını koruyoruz, slotları siliyoruz */
        :root { --bg:#02000f; --ai1:#a5b4fc; --good:#2ecc71; }
        body { background: var(--bg); color: white; font-family: sans-serif; overflow: hidden; display: flex; justify-content: center; align-items: center; height: 100vh; margin: 0; }
        .wrap { width: min(400px, 95vw); display: flex; flex-direction: column; gap: 15px; }
        .target-area { background: rgba(255,255,255,0.05); padding: 20px; border-radius: 20px; text-align: center; border: 1px solid rgba(255,255,255,0.1); }
        .tr-word { font-size: 32px; font-weight: 900; color: var(--ai1); letter-spacing: 2px; }
        #grid { display: grid; grid-template-columns: repeat(8, 1fr); gap: 4px; background: rgba(0,0,0,0.3); padding: 10px; border-radius: 15px; border: 1px solid rgba(255,255,255,0.1); }
        .cell { aspect-ratio: 1/1; background: rgba(255,255,255,0.08); border-radius: 8px; display: flex; align-items: center; justify-content: center; font-size: 18px; font-weight: 800; cursor: pointer; transition: 0.1s; border: 1px solid transparent; }
        .cell.selected { border-color: var(--ai1); background: rgba(165,180,252,0.3); transform: scale(1.1); z-index: 10; }
        .cell.pop { background: var(--good); color: white; animation: pulse 0.4s; }
        @keyframes pulse { 0% { transform: scale(1); } 50% { transform: scale(1.2); } 100% { transform: scale(1); } }
    </style>
</head>
<body>

<div class="wrap">
    <div class="target-area">
        <div id="tr-display" class="tr-word">YÜKLENİYOR...</div>
        <div style="font-size: 10px; opacity: 0.5; margin-top: 5px;">İNGİLİZCESİNİ TAHTADA OLUŞTUR</div>
    </div>
    
    <div id="grid"></div>
    
    <div id="score-board" style="text-align: center; font-weight: 900;">PUAN: <span id="score">0</span></div>
</div>

<script>
const ROWS = 10; const COLS = 8;
const WORDS = [ {tr:"EV", en:"HOUSE"}, {tr:"ARABA", en:"CAR"}, {tr:"KEDİ", en:"CAT"}, {tr:"ELMA", en:"APPLE"} ];
let currentTarget = WORDS[0];
let board = Array(ROWS).fill().map(() => Array(COLS).fill(""));
let selected = null;
let score = 0;

function init() {
    const grid = document.getElementById("grid");
    grid.innerHTML = "";
    for(let r=0; r<ROWS; r++) {
        for(let c=0; c<COLS; c++) {
            const cell = document.createElement("div");
            cell.className = "cell";
            cell.id = `c-${r}-${c}`;
            cell.onclick = () => clickCell(r, c);
            grid.appendChild(cell);
        }
    }
    nextWord();
    gameLoop();
}

function nextWord() {
    currentTarget = WORDS[Math.floor(Math.random()*WORDS.length)];
    document.getElementById("tr-display").innerText = currentTarget.tr;
}

function clickCell(r, c) {
    if (!board[r][c]) return;
    if (!selected) {
        selected = {r, c};
        document.getElementById(`c-${r}-${c}`).classList.add("selected");
    } else {
        // Swap
        let temp = board[r][c];
        board[r][c] = board[selected.r][selected.c];
        board[selected.r][selected.c] = temp;
        
        document.getElementById(`c-${selected.r}-${selected.c}`).classList.remove("selected");
        selected = null;
        render();
        checkBoard();
    }
}

function checkBoard() {
    const word = currentTarget.en;
    const len = word.length;
    // Basit Yatay Tarama Örneği
    for(let r=0; r<ROWS; r++) {
        for(let c=0; c <= COLS - len; c++) {
            let slice = "";
            for(let i=0; i<len; i++) slice += board[r][c+i];
            if(slice === word) {
                popWord(r, c, 0, 1, len); // Yatay patlat
                return;
            }
        }
    }
    // Dikey ve Çapraz tarama mantığı buraya eklenecek...
}

function popWord(r, c, dr, dc, len) {
    score += 100;
    document.getElementById("score").innerText = score;
    // Patlama efekti ve italkyAI Seslendirme (TTS) simülasyonu
    const msg = new SpeechSynthesisUtterance(currentTarget.en);
    window.speechSynthesis.speak(msg);

    for(let i=0; i<len; i++) {
        board[r + i*dr][c + i*dc] = "";
    }
    setTimeout(() => {
        applyGravity();
        render();
        nextWord();
    }, 500);
}

function applyGravity() {
    for(let c=0; c<COLS; c++) {
        for(let r=ROWS-1; r>0; r--) {
            if(board[r][c] === "" && board[r-1][c] !== "") {
                board[r][c] = board[r-1][c];
                board[r-1][c] = "";
                r = ROWS; // Tekrar kontrol et
            }
        }
    }
}

function dropLetter() {
    const emptyCols = [];
    for(let c=0; c<COLS; c++) if(board[0][c] === "") emptyCols.push(c);
    
    if(emptyCols.length === 0) { alert("Game Over!"); return; }
    
    const col = emptyCols[Math.floor(Math.random()*emptyCols.length)];
    // Akıllı harf: Hedef kelimeden harf düşürme şansı %70
    const char = Math.random() < 0.7 ? currentTarget.en[Math.floor(Math.random()*currentTarget.en.length)] : "ABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(Math.random()*26)];
    
    board[0][col] = char;
    applyGravity();
    render();
}

function render() {
    for(let r=0; r<ROWS; r++) {
        for(let c=0; c<COLS; c++) {
            const el = document.getElementById(`c-${r}-${c}`);
            el.innerText = board[r][c];
            el.style.opacity = board[r][c] ? "1" : "0";
        }
    }
}

function gameLoop() {
    dropLetter();
    setTimeout(gameLoop, 2000); // 2 saniyede bir düşer
}

init();
</script>
</body>
</html>
