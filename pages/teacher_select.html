<!-- FILE: /pages/teacher_select.html -->
<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover" />
<title>italkyAI â€¢ Dil SeÃ§</title>
<link rel="icon" href="data:," />
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Outfit:wght@400;600;800;900&family=Space+Grotesk:wght@700&display=swap" rel="stylesheet">

<style>
  #pageContent{ height:100%; }

  /* âœ… EÅžÄ°T BOÅžLUK (Ã¼st-alt / saÄŸ-sol) ve min boÅŸluk */
  .wrap{
    height:100%;
    padding: 12px 12px; /* eÅŸit */
    overflow:hidden;
    display:flex;
  }

  /* âœ… Grid alanÄ± TAM dolacak */
  .grid{
    flex:1;
    width:100%;
    display:grid;
    grid-template-columns: 1fr 1fr;
    gap: 12px;                 /* az boÅŸluk */
    grid-auto-rows: var(--cardH); /* JS set eder */
  }

  /* âœ… Kartlar kareye yakÄ±n */
  .card{
    height: var(--cardH);
    border-radius: 26px;
    border: 1px solid rgba(255,255,255,0.10);
    background: linear-gradient(145deg, rgba(255,255,255,0.08) 0%, rgba(255,255,255,0.02) 100%);
    padding: 12px;
    cursor:pointer;
    user-select:none;
    transition:.2s;
    display:flex;
    flex-direction:column;
    align-items:center;
    justify-content:center;
    text-align:center;
    gap: 8px;
  }
  .card:active{ transform: scale(.95); }

  /* ikon kutusu (home gibi) */
  .iconWrap{
    width: var(--iconBox);
    height: var(--iconBox);
    border-radius: 22px;
    display:flex;
    align-items:center;
    justify-content:center;
    background: rgba(255,255,255,0.05);
    border: 1px solid rgba(255,255,255,0.12);
  }
  .flag{
    font-size: var(--flagSize);
    line-height:1;
  }

  /* Ã¶nce rol kÃ¼Ã§Ã¼k */
  .role{
    font-size: var(--roleSize);
    font-weight: 900;
    color: rgba(255,255,255,0.65);
    line-height:1.1;
  }

  /* sonra isim bÃ¼yÃ¼k */
  .name{
    font-size: var(--nameSize);
    font-weight: 1000;
    letter-spacing: -0.4px;
    line-height:1.05;
    color:#fff;
  }
</style>
</head>

<body>
<main id="pageContent">
  <div class="wrap">
    <div class="grid" id="teacherGrid"></div>
  </div>
</main>

<script type="module">
  import { mountShell } from "/js/ui_shell.js";
  mountShell({ scroll:"none" });

  const KEY_TEACHER="italky_teacher_pref";
  const KEY_LEVEL_DONE="italky_level_done";
  const KEY_PLAN="italky_plan_pref";
  const KEY_MINS="italky_lesson_mins";

  const TEACHERS = [
    { id:"dora",   flag:"ðŸ‡¬ðŸ‡§", role:"Ä°ngilizce Ã–ÄŸretmeni",   name:"Dora" },
    { id:"ayda",   flag:"ðŸ‡©ðŸ‡ª", role:"Almanca Ã–ÄŸretmeni",     name:"Ayda" },
    { id:"jale",   flag:"ðŸ‡«ðŸ‡·", role:"FransÄ±zca Ã–ÄŸretmeni",   name:"Jale" },
    { id:"ozan",   flag:"ðŸ‡ªðŸ‡¸", role:"Ä°spanyolca Ã–ÄŸretmeni",  name:"Ozan" },
    { id:"sencer", flag:"ðŸ‡®ðŸ‡¹", role:"Ä°talyanca Ã–ÄŸretmeni",   name:"Sencer" },
    { id:"sungur", flag:"ðŸ‡·ðŸ‡º", role:"RusÃ§a Ã–ÄŸretmeni",       name:"Sungur" },
    { id:"huma",   flag:"ðŸ‡¯ðŸ‡µ", role:"Japonca Ã–ÄŸretmeni",     name:"HÃ¼ma" },
    { id:"umay",   flag:"ðŸ‡¨ðŸ‡³", role:"Ã‡ince Ã–ÄŸretmeni",       name:"Umay" },
  ];

  const $ = id => document.getElementById(id);

  function goNext(){
    const levelDone = (localStorage.getItem(KEY_LEVEL_DONE)||"")==="1";
    if(!levelDone){ location.href="/pages/level_test.html"; return; }

    const plan = (localStorage.getItem(KEY_PLAN)||"").trim();
    const mins = (localStorage.getItem(KEY_MINS)||"").trim();
    if(plan && mins) location.href="/pages/teacher_course.html";
    else location.href="/pages/plan_select.html";
  }

  function render(){
    const grid = $("teacherGrid");
    grid.innerHTML = TEACHERS.map(t=>`
      <div class="card" data-id="${t.id}">
        <div class="iconWrap"><div class="flag">${t.flag}</div></div>
        <div class="role">${t.role}</div>
        <div class="name">${t.name}</div>
      </div>
    `).join("");

    grid.querySelectorAll(".card").forEach(c=>{
      c.addEventListener("click", ()=>{
        localStorage.setItem(KEY_TEACHER, c.getAttribute("data-id"));
        goNext();
      });
    });
  }

  /* âœ… TAM SIÄžDIRMA: header+footer arasÄ± yÃ¼ksekliÄŸi 4 satÄ±ra bÃ¶l */
  function fit(){
    const header = document.querySelector(".premium-header");
    const footer = document.querySelector(".premium-footer");
    const headerH = header ? header.offsetHeight : 0;
    const footerH = footer ? footer.offsetHeight : 0;

    // wrap padding: 12 + 12 (Ã¼st-alt) + kÃ¼Ã§Ã¼k emniyet
    const usable = window.innerHeight - headerH - footerH - 28;

    const rows = 4;     // 8 kart => 4 satÄ±r
    const gap  = 12;    // CSS gap

    // kart yÃ¼ksekliÄŸi (tam sÄ±ÄŸar)
    let cardH = (usable - (gap * (rows - 1))) / rows;

    // kareye yakÄ±n gÃ¶rÃ¼nÃ¼m iÃ§in min/max (Ã§ok taÅŸarsa deÄŸil)
    cardH = Math.max(135, Math.min(185, cardH));

    // ikon kutusu kartÄ±n iÃ§inde orantÄ±lÄ±
    const iconBox = Math.max(52, Math.min(78, cardH * 0.44));
    const flagSize = Math.max(22, Math.min(34, iconBox * 0.42));

    const roleSize = Math.max(11, Math.min(13, cardH * 0.10));
    const nameSize = Math.max(16, Math.min(20, cardH * 0.14));

    document.documentElement.style.setProperty("--cardH", cardH + "px");
    document.documentElement.style.setProperty("--iconBox", iconBox + "px");
    document.documentElement.style.setProperty("--flagSize", flagSize + "px");
    document.documentElement.style.setProperty("--roleSize", roleSize + "px");
    document.documentElement.style.setProperty("--nameSize", nameSize + "px");
  }

  render();
  requestAnimationFrame(()=>fit());
  window.addEventListener("resize", fit);
</script>
</body>
</html>
