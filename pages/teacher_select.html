<!-- FILE: /pages/teacher_select.html -->
<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover" />
<title>italkyAI ‚Ä¢ Dil Se√ß</title>
<link rel="icon" href="data:," />
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Outfit:wght@400;600;800;900&family=Space+Grotesk:wght@700&display=swap" rel="stylesheet">

<style>
  #pageContent{ height:100%; }

  .wrap{
    height:100%;
    padding: 12px 12px 18px;
    overflow:hidden;
    display:flex;
  }

  .grid{
    flex:1;
    width:100%;
    display:grid;
    grid-template-columns: 1fr 1fr;
    gap: 12px;
    grid-auto-rows: var(--cardH);
  }

  .card{
    height: var(--cardH);
    border-radius: 26px;
    border: 1px solid rgba(255,255,255,0.10);
    background: linear-gradient(
      145deg,
      rgba(255,255,255,0.08) 0%,
      rgba(255,255,255,0.02) 100%
    );
    padding: 12px;
    cursor:pointer;
    user-select:none;
    transition:.2s;
    display:flex;
    flex-direction:column;
    align-items:center;
    justify-content:center;
    text-align:center;
    gap: 8px;
  }
  .card:active{ transform: scale(.95); }

  .iconWrap{
    width: var(--iconBox);
    height: var(--iconBox);
    border-radius: 22px;
    display:flex;
    align-items:center;
    justify-content:center;
    background: rgba(255,255,255,0.05);
    border: 1px solid rgba(255,255,255,0.12);
  }

  .flag{
    font-size: var(--flagSize);
    line-height:1;
  }

  .role{
    font-size: var(--roleSize);
    font-weight: 900;
    color: rgba(255,255,255,0.65);
    line-height:1.1;
  }

  .name{
    font-size: var(--nameSize);
    font-weight: 1000;
    letter-spacing: -0.4px;
    line-height:1.05;
    color:#fff;
  }
</style>
</head>

<body>
<main id="pageContent">
  <div class="wrap">
    <div class="grid" id="teacherGrid"></div>
  </div>
</main>

<script type="module">
  import { mountShell } from "/js/ui_shell.js";
  mountShell({ scroll:"none" });

  const KEY_TEACHER="italky_teacher_pref";
  const KEY_LEVEL_DONE="italky_level_done";
  const KEY_PLAN="italky_plan_pref";
  const KEY_MINS="italky_lesson_mins";

  const TEACHERS = [
    { id:"dora",   flag:"üá¨üáß", role:"ƒ∞ngilizce √ñƒüretmeni",   name:"Dora" },
    { id:"ayda",   flag:"üá©üá™", role:"Almanca √ñƒüretmeni",     name:"Ayda" },
    { id:"jale",   flag:"üá´üá∑", role:"Fransƒ±zca √ñƒüretmeni",   name:"Jale" },
    { id:"ozan",   flag:"üá™üá∏", role:"ƒ∞spanyolca √ñƒüretmeni",  name:"Ozan" },
    { id:"sencer", flag:"üáÆüáπ", role:"ƒ∞talyanca √ñƒüretmeni",   name:"Sencer" },
    { id:"sungur", flag:"üá∑üá∫", role:"Rus√ßa √ñƒüretmeni",       name:"Sungur" },
    { id:"huma",   flag:"üáØüáµ", role:"Japonca √ñƒüretmeni",     name:"H√ºma" },
    { id:"umay",   flag:"üá®üá≥", role:"√áince √ñƒüretmeni",       name:"Umay" },
  ];

  const $ = id => document.getElementById(id);

  function goNext(){
    const levelDone = (localStorage.getItem(KEY_LEVEL_DONE)||"")==="1";

    // ‚úÖ ƒ∞lk kez ‚Üí intro sayfasƒ±
    if(!levelDone){
      location.href="/pages/level_test_intro.html";
      return;
    }

    // ‚úÖ Seviye yapƒ±ldƒ±ysa
    const plan = (localStorage.getItem(KEY_PLAN)||"").trim();
    const mins = (localStorage.getItem(KEY_MINS)||"").trim();

    if(plan && mins){
      location.href="/pages/teacher_course.html";
    } else {
      location.href="/pages/plan_select.html";
    }
  }

  function render(){
    const grid = $("teacherGrid");
    grid.innerHTML = TEACHERS.map(t=>`
      <div class="card" data-id="${t.id}">
        <div class="iconWrap"><div class="flag">${t.flag}</div></div>
        <div class="role">${t.role}</div>
        <div class="name">${t.name}</div>
      </div>
    `).join("");

    grid.querySelectorAll(".card").forEach(c=>{
      c.addEventListener("click", ()=>{
        localStorage.setItem(KEY_TEACHER, c.getAttribute("data-id"));
        goNext();
      });
    });
  }

  function fit(){
    const header = document.querySelector(".premium-header");
    const footer = document.querySelector(".premium-footer");
    const headerH = header ? header.offsetHeight : 0;
    const footerH = footer ? footer.offsetHeight : 0;

    const usable = window.innerHeight - headerH - footerH - 46;

    const rows = 4;
    const gap  = 12;

    let cardH = (usable - (gap * (rows - 1))) / rows;
    cardH = Math.max(130, Math.min(180, cardH));

    const iconBox  = Math.max(52, Math.min(74, cardH * 0.44));
    const flagSize = Math.max(22, Math.min(32, iconBox * 0.42));
    const roleSize = Math.max(11, Math.min(13, cardH * 0.10));
    const nameSize = Math.max(16, Math.min(20, cardH * 0.14));

    document.documentElement.style.setProperty("--cardH", cardH + "px");
    document.documentElement.style.setProperty("--iconBox", iconBox + "px");
    document.documentElement.style.setProperty("--flagSize", flagSize + "px");
    document.documentElement.style.setProperty("--roleSize", roleSize + "px");
    document.documentElement.style.setProperty("--nameSize", nameSize + "px");
  }

  render();
  requestAnimationFrame(()=>fit());
  window.addEventListener("resize", fit);
</script>
</body>
</html>
