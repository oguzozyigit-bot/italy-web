<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover" />
<title>italkyAI ‚Ä¢ Dil Dersi Se√ßimi</title>
<link href="https://fonts.googleapis.com/css2?family=Outfit:wght@400;600;800;900&family=Space+Grotesk:wght@700&display=swap" rel="stylesheet">
<style>
  #pageContent { height: 100%; overflow: hidden; }
  .wrap { height: 100%; padding: 10px 16px 20px; display: flex; flex-direction: column; justify-content: flex-start; }
  .title-area { margin-bottom: 16px; text-align: center; padding-top: 5px; }
  .title-area h2 { font-size: 22px; font-weight: 900; margin: 0; background: linear-gradient(135deg, #ffffff 0%, #a5b4fc 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
  .grid { flex: 1; width: 100%; display: grid; grid-template-columns: 1fr 1fr; gap: 10px; grid-auto-rows: var(--cardH); align-content: start; }
  .card { border-radius: 28px; border: 1px solid rgba(255,255,255,0.08); background: linear-gradient(165deg, rgba(255,255,255,0.06) 0%, rgba(255,255,255,0.01) 100%); backdrop-filter: blur(20px); cursor: pointer; transition: all 0.3s ease; display: flex; flex-direction: column; align-items: center; justify-content: center; text-align: center; position: relative; }
  .iconWrap { width: var(--iconBox); height: var(--iconBox); border-radius: 20px; display: flex; align-items: center; justify-content: center; background: rgba(99, 102, 241, 0.1); border: 1px solid rgba(99, 102, 241, 0.2); margin-bottom: 8px; }
  .flag { font-size: var(--flagSize); filter: drop-shadow(0 2px 4px rgba(0,0,0,0.2)); }
  .role { font-size: var(--roleSize); font-weight: 800; color: #a5b4fc; text-transform: uppercase; letter-spacing: 1.2px; margin-bottom: 2px; }
  .name { font-size: var(--nameSize); font-weight: 900; color: #fff; }
  .card:active { transform: scale(0.95); background: rgba(99, 102, 241, 0.15); }
</style>
</head>
<body>
<main id="pageContent">
  <div class="wrap">
    <div class="title-area"><h2>Dil Dersi Se√ßimi Yapƒ±n</h2></div>
    <div class="grid" id="teacherGrid"></div>
  </div>
</main>
<script type="module">
  import { mountShell } from "/js/ui_shell.js";
  import { bootPage } from "/js/ui_guard.js";

  mountShell({ scroll: "none" });
  bootPage({ protectedPage: true, header: { nameId: "userName", picId: "userPic" } });

  const TEACHERS = [
    { id: "jack",    flag: "üá¨üáß", role: "English",   name: "Jack",    voice: "onyx" },
    { id: "heidi",   flag: "üá©üá™", role: "Deutsch",   name: "Heidi",   voice: "shimmer" },
    { id: "claire",  flag: "üá´üá∑", role: "Fran√ßais",  name: "Claire",  voice: "nova" },
    { id: "diego",   flag: "üá™üá∏", role: "Espa√±ol",   name: "Diego",   voice: "echo" },
    { id: "marco",   flag: "üáÆüáπ", role: "Italiano",  name: "Marco",   voice: "fable" },
    { id: "elena",   flag: "üá∑üá∫", role: "P—É—Å—Å–∫–∏–π",   name: "Elena",   voice: "alloy" },
    { id: "kenji",   flag: "üáØüáµ", role: "Êó•Êú¨Ë™û",     name: "Kenji",   voice: "onyx" },
    { id: "mei",     flag: "üá®üá≥", role: "‰∏≠Êñá",       name: "Mei-Ling",voice: "shimmer" }
  ];

  function render() {
    const grid = document.getElementById("teacherGrid");
    grid.innerHTML = TEACHERS.map(t => `
      <div class="card" data-id="${t.id}" data-voice="${t.voice}">
        <div class="iconWrap"><div class="flag">${t.flag}</div></div>
        <div class="role">${t.role}</div>
        <div class="name">${t.name}</div>
      </div>`).join("");

    grid.querySelectorAll(".card").forEach(c => {
      c.addEventListener("click", () => {
        const tid = c.getAttribute("data-id");
        localStorage.setItem("italky_teacher_pref", tid);
        localStorage.setItem("italky_voice_pref", c.getAttribute("data-voice"));
        
        // Dil bazlƒ± seviye kontrol√º
        const hasLevel = localStorage.getItem(`italky_level_${tid}`);
        location.href = hasLevel ? "/pages/plan_select.html" : "/pages/level_test.html";
      });
    });
  }

  function fit() {
    const h = document.querySelector(".premium-header")?.offsetHeight || 0;
    const f = document.querySelector(".premium-footer")?.offsetHeight || 0;
    const usable = window.innerHeight - h - f - 120;
    const cardH = Math.floor(usable / 4.2);
    document.documentElement.style.setProperty("--cardH", cardH + "px");
    document.documentElement.style.setProperty("--iconBox", (cardH * 0.4) + "px");
    document.documentElement.style.setProperty("--flagSize", (cardH * 0.2) + "px");
    document.documentElement.style.setProperty("--roleSize", (cardH * 0.08) + "px");
    document.documentElement.style.setProperty("--nameSize", (cardH * 0.13) + "px");
  }

  render();
  requestAnimationFrame(fit);
  window.addEventListener("resize", fit);
</script>
</body>
</html>
