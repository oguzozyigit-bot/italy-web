<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover" />
  <title>italkyAI ‚Ä¢ Neural Home</title>
  <style>
    :root {
      --glow-bordo: #ff1e56;
      --glow-cyan: #00f2ff;
      --deep-void: #02000f;
    }

    #pageContent {
      height: 100%;
      display: flex;
      flex-direction: column;
      justify-content: space-around;
      padding: 10px 0;
      perspective: 1200px;
    }

    /* --- NEURAL CORE (FaceToFace) --- */
    .neural-core {
      position: relative;
      width: 100%;
      height: 240px;
      background: radial-gradient(circle at center, rgba(157, 27, 61, 0.2) 0%, transparent 70%);
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
    }

    .core-orb {
      width: 140px; height: 140px;
      background: #000;
      border-radius: 50%;
      position: relative;
      border: 1px solid rgba(255,255,255,0.1);
      box-shadow: 0 0 50px var(--glow-bordo), inset 0 0 30px var(--glow-bordo);
      display: flex; align-items: center; justify-content: center;
      animation: orbPulse 4s infinite ease-in-out;
    }

    /* √ñzel √áizim AI ƒ∞konu (Neural Paths) */
    .ai-symbol {
      width: 60px; height: 60px;
      position: relative;
    }
    .ai-symbol::before, .ai-symbol::after {
      content: ""; position: absolute; border: 2px solid #fff; border-radius: 50%;
      inset: 10%; animation: rotateSymbol 6s infinite linear;
    }
    .ai-symbol::after { inset: 25%; border-color: var(--glow-cyan); animation-direction: reverse; }

    .core-label {
      position: absolute; bottom: -40px; text-align: center;
      width: 100%;
    }
    .core-label h2 { margin: 0; font-size: 28px; font-weight: 900; letter-spacing: 2px; color: #fff; text-shadow: 0 0 20px var(--glow-bordo); }
    .core-label span { font-size: 10px; font-weight: 800; color: var(--glow-cyan); letter-spacing: 4px; }

    /* --- FLOATING MODULES GRID --- */
    .modules-container {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 20px;
      padding: 40px 10px 0;
    }

    .module-item {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 12px;
      cursor: pointer;
      transition: transform 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    }
    .module-item:active { transform: scale(1.2) translateY(-10px); }

    /* √ñzel CSS ƒ∞kon √áizimleri */
    .icon-blob {
      width: 54px; height: 54px;
      border-radius: 18px;
      background: rgba(255,255,255,0.03);
      border: 1px solid rgba(255,255,255,0.1);
      backdrop-filter: blur(10px);
      display: flex; align-items: center; justify-content: center;
      position: relative;
      box-shadow: 0 10px 20px rgba(0,0,0,0.4);
    }

    /* CSS ile √ñzel ƒ∞konlar (Hazƒ±r Deƒüil) */
    .draw-text::before { content: "A„ÅÇ"; font-weight: 900; color: #34d399; font-size: 20px; }
    .draw-photo::before { content: ""; width: 20px; height: 16px; border: 2px solid #60a5fa; border-radius: 3px; position:relative; }
    .draw-photo::after { content: ""; width: 6px; height: 6px; background: #60a5fa; border-radius: 50%; position:absolute; top: 18px; right: 18px; }
    .draw-doc::before { content: ""; width: 14px; height: 18px; border: 2px solid #f472b6; border-top-right-radius: 6px; }
    .draw-game::before { content: "üéÆ"; font-size: 24px; filter: drop-shadow(0 0 8px #fbbf24); }
    .draw-chat::before { content: ""; width: 20px; height: 14px; border: 2px solid #818cf8; border-radius: 10px 10px 10px 0; }
    .draw-academy::before { content: "it"; font-family: serif; font-style: italic; font-weight: 900; font-size: 24px; color: #fff; }

    .module-item label { font-size: 10px; font-weight: 900; color: rgba(255,255,255,0.5); text-transform: uppercase; letter-spacing: 1px; }

    /* Animasyonlar */
    @keyframes orbPulse {
      0%, 100% { transform: scale(1); box-shadow: 0 0 40px var(--glow-bordo); }
      50% { transform: scale(1.05); box-shadow: 0 0 70px var(--glow-bordo); }
    }
    @keyframes rotateSymbol {
      from { transform: rotate(0deg); }
      to { transform: rotate(360deg); }
    }

    /* Offline/Kilit Durumu */
    .locked { opacity: 0.2; filter: blur(2px); pointer-events: none; }
  </style>
</head>

<body>
  <div id="pageContent">
    
    <div class="neural-core" id="btnFfStart" data-href="/pages/facetoface.html">
      <div class="core-orb">
        <div class="ai-symbol"></div>
      </div>
      <div class="core-label">
        <span>INTERFACE ACTIVE</span>
        <h2>FaceToFace</h2>
      </div>
    </div>

    <div class="modules-container">
      
      <div class="module-item" id="tileText" data-href="/pages/text_translate.html">
        <div class="icon-blob draw-text"></div>
        <label>Metin</label>
      </div>

      <div class="module-item" id="tileChat" data-href="/pages/teacher_select.html">
        <div class="icon-blob draw-chat"></div>
        <label>Sohbet</label>
      </div>

      <div class="module-item" id="tilePhoto" data-href="/pages/photo.html">
        <div class="icon-blob draw-photo"></div>
        <label>G√∂rsel</label>
      </div>

      <div class="module-item" id="tileAcademy" data-href="/pages/teacher_select.html">
        <div class="icon-blob draw-academy"></div>
        <label>Academy</label>
      </div>

      <div class="module-item" id="tileDoc" data-href="/pages/document.html">
        <div class="icon-blob draw-doc"></div>
        <label>Belge</label>
      </div>

      <div class="module-item" id="tileGame" data-href="/pages/game.html">
        <div class="icon-blob draw-game"></div>
        <label>Oyun</label>
      </div>

    </div>

  </div>

  <script type="module">
    import { mountShell, setHeaderTokens } from "/js/ui_shell.js";
    import { bootPage } from "/js/ui_guard.js";
    import { ensureAuthAndCacheUser } from "/js/auth.js";

    mountShell({ scroll: "none" });

    const cached = await ensureAuthAndCacheUser();
    if (cached?.tokens != null) setHeaderTokens(cached.tokens);
    bootPage({ protectedPage: true, header: { nameId: "userName", picId: "userPic" } });

    function handleState() {
      const isOnline = navigator.onLine;
      const user = JSON.parse(localStorage.getItem('italky_user_v1') || '{}');
      const hasOff = (user.offline_langs || []).length > 0;

      const logic = {
        tileText: isOnline || hasOff,
        tilePhoto: isOnline,
        tileDoc: isOnline,
        tileGame: true,
        tileChat: isOnline,
        tileAcademy: isOnline
      };

      Object.entries(logic).forEach(([id, ok]) => {
        const el = document.getElementById(id);
        if(!ok) el.classList.add('locked'); else el.classList.remove('locked');
      });
    }

    document.querySelectorAll("[data-href]").forEach(el => {
      el.onclick = () => { if(!el.classList.contains('locked')) location.href = el.dataset.href; };
    });

    handleState();
  </script>
</body>
</html>
